### 7.5.1 장치 이동성 : 네트워크 계층의 관점

물리적인 이동장치가 네트워크 접속점을 이동할 때 그 장치가 얼마나 활성화된 상태인가에 따라 네트워크 계층에 문제 제기

(a) 무선 네트워크 연결을 끊고 이동하면서 다른 무선 네트워크에 연결하는 것
-> 네트워킹 관점에서 장치는 이동중인것이 아님
전원이 켜져있는동안 하나의 네트워크에만 접속하며 이동하지 않고 머물기 때문
-> 무선 접속 네트워크들과 차례대로 결합하고 분리하고를 반복 -> 비 이동성

(b) 물리적으로 이동 가능하지만 동일한 접속 네트워크에 연결된 상태 유지
-> 동일한 AP 또는 LTE 기지국과 연결된 상태로 유지됨 -> 모바일 x

(c) 이동장치가 TCP와 같은 상위 레벨 연결을 유지하고 ip데이터그램을 계쏙 보내고 받는 상태에서 접속 네트워크 연결 (네트워크 장치가 이동시 핸드오버 제공) 

### (a) 접속 네트워크 간 장치 이동성, 이동 중에는 전원을 끔

이곳에는 네트워크 사이를 물리적으로 이동하지만 이때 이동 장치의 전원을 끄고 움직이는 이동 사용자가 위치한다.

전원이 켜져 있는 동안 하나의 네트워크에만 접속하며 이동하지 않고 머물기 때문에, 네트워킹 관점에서 이 장치는 이동 중인 것, 즉 `모바일`이 아니다.

  

### [](https://github.com/IT-Book-Organization/Computer-Networking_A-Top-Down-Approach/tree/main/Chapter_7/7.5%20%EC%9D%B4%EB%8F%99%EC%84%B1%20%EA%B4%80%EB%A6%AC%3A%20%EC%9B%90%EC%B9%99#b-%ED%95%98%EB%82%98%EC%9D%98-%EB%8F%99%EC%9D%BC%ED%95%9C-%EB%AC%B4%EC%84%A0-%EC%A0%91%EC%86%8D-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%95%88%EC%97%90%EC%84%9C%EC%9D%98-%EC%9E%A5%EC%B9%98-%EC%9D%B4%EB%8F%99%EC%84%B1)(b) 하나의 동일한 무선 접속 네트워크 안에서의 장치 이동성

이동 장치는 물리적으로 이동 가능하지만 동일한 접속 네트워크에 연결된 상태를 유지한다.

이러한 장치도 네트워크 계층 관점에서는 모바일이 아니다.

  

또한 장치가 동일한 802.11 AP 또는 LTE 기지국과 연결된 상태로 유지되는 경우, 해당 장치는 링크 계층 관점에서도 모바일이 아니다.

  
  

_네트워크 관점에서 장치 이동성에 대한 관심은 여기서부터 시작한다._

### [](https://github.com/IT-Book-Organization/Computer-Networking_A-Top-Down-Approach/tree/main/Chapter_7/7.5%20%EC%9D%B4%EB%8F%99%EC%84%B1%20%EA%B4%80%EB%A6%AC%3A%20%EC%9B%90%EC%B9%99#c-%EC%A7%84%ED%96%89%EC%A4%91%EC%9D%B8-%EC%97%B0%EA%B2%B0%EC%9D%84-%EC%9C%A0%EC%A7%80%ED%95%98%EB%A9%B0-%EB%8F%99%EC%9D%BC-%ED%86%B5%EC%8B%A0-%EC%82%AC%EC%97%85%EC%9E%90-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EB%82%B4%EC%97%90%EC%84%9C%EC%9D%98-%EC%9E%A5%EC%B9%98-%EC%9D%B4%EB%8F%99%EC%84%B1)(c) 진행중인 연결을 유지하며 동일 통신 사업자 네트워크 내에서의 장치 이동성

1. 이동 장치는 TCP와 같은 상위 레벨 연결을 유지하고, IP 데이터그램을 계속 보내고 받는 상태에서
2. 접속 네트워크(802.11 WLAN 또는 LTE 셀)를 변경한다.

  

여기서 네트워크는 장치가 WLAN 또는 LTE 셀 간에 이동할 때 `핸드오버(handover)`를 제공해야 한다.  
(하나의 AP/기지국에서 다른 AP/기지국으로 데이터그램을 책임지고 전달하는 것)

  

### [](https://github.com/IT-Book-Organization/Computer-Networking_A-Top-Down-Approach/tree/main/Chapter_7/7.5%20%EC%9D%B4%EB%8F%99%EC%84%B1%20%EA%B4%80%EB%A6%AC%3A%20%EC%9B%90%EC%B9%99#d-%EC%A7%84%ED%96%89-%EC%A4%91%EC%9D%B8-%EC%97%B0%EA%B2%B0%EC%9D%84-%EC%9C%A0%EC%A7%80%ED%95%98%EB%A9%B0-%EC%97%AC%EB%9F%AC-%ED%86%B5%EC%8B%A0-%EC%82%AC%EC%97%85%EC%9E%90-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EA%B0%84%EC%9D%98-%EC%9E%A5%EC%B9%98-%EC%9D%B4%EB%8F%99%EC%84%B1)(d) 진행 중인 연결을 유지하며 여러 통신 사업자 네트워크 간의 장치 이동성

이동 장치가 여러 사업자 네트워크들 사이를 로밍하는 경우이다.

이때 사업자들은 핸드오버를 함께 협력해서 처리해야 하므로 핸드오버 절차가 상당히 복잡해진다.

#### 7.5.2 홈 네트워크 및 방문 네트워크로의 로밍

HSS (Home subscriber Service) 
- 가입자들에 대한 정보 저장
	- 고유한 장치 ID
	- 가입자가 접속할 수 있는 서비스에 대한 정보
	- 통신에 사용되는 암호화 키
	- 요금 청구 및 과금 정보 등

이동장치가 홈 네트워크가 아닌 다른 셀룰러 네트워크와 연결 -> 방문 네트워크에서 로밍중

이동 장치가 홈 네트워크를 갖는다는 개념은 두가지 장점 제공
- 홈 네트워크는 해당 장치에 대한 정보를 제공할 수 있는 단일한 위치를 제공
- 로밍중인 이동 장치와의 통신을 위해 조정 지점의 역할 수행

#### 7.5.3 이동 장치로의 직접 라우팅과 간접 라우팅

통신자 : 홈 네트워크에 있거나 방문 네트워크에 로밍중인 어떤 이동장치와 통신하기 원하는 호스트

이동장치가 홈 네트워크가 아닌 다른 셀룰러 네트워크와 연결
-> 장치가 방문 네트워크에서 로밍중, 홈 네트워크와 방문 네트워크 간의 조정 작업 필요

현재는 홈 네트워크와 방문 네트워크에 대한 개념이 명확하지 않음
-> 이동 IP 프로토콜 : 실제로는 제한적으로 사용
-> Eduroam : 기존에 구축된 ip 인프라스트럭처 위에서 방문 ip 네트워크에서의 인증된 네트워크 접속을 제공하기 위한 활동

 이동장치가 홈 네트워크를 갖는다
- 홈 네트워크는 해당 장치에 대한 정보를 제공할 수 있는 단일한 위치 제공
- 로밍중인 이동 장치와의 통신을 위한 조정 지점의 역할 수행

### 7.5.3 이동 장치로의 직접 라우팅과 간접 라우팅

통신자 : 홈 네트워크에 있거나 방문 네트워크에 로밍중인 어떤 이동장치와 통신하기를 원함
-> 통신자가 보낸 데이터그램이 해당 이동장치에 도달(라우팅) 할 수 있도록 하는 접근방식 3가지

1. 기존 ip 주소 인프라 활용
	1. isp는 bgp를 통해 도달 가능한 네트워크의 cidr화된 주소 범위를 열거하여 목적지 네트워크에 대한 경로를 광고함
	2. 즉, ===이동장치의 영구적인 ip주소를 광고하여 데이터그램을 해당 이동장치로 전달하는 데 사용할 경로가 있음을 다른 네트워크들에게 알림
	3. ===인접 네트워크들은 라우팅 정보 및 포워딩 테이블 갱신 절차를 사용해 네트워크 전체에 이 정보를 전파
	4. 데이터그램은 항상 해당 주소에 대한 가장 구체적인 목적지를 광고하는 라우터로 전달되므로 해당 이동장치를 목적지로 하는 모든 데이터그램은 방문 네트워크로 전달
	5. ===다른 네트워크들은 이동 장치의 위치를 알고있으며, 포워딩 테이블들이 데이터그램을 방문 네트워크로 안내하기 때문에 데이터그램을 그 이동장치로 쉽게 라우팅 가능
	6. 단점 : 확장성 , 이동장치에 대한 포워딩 테이블 항목을 유지관리해야하고, 다른 네트워크로 로밍할 때마다 장치 관련 항목을 갱신해야 함
	7. 이동성 관리 기능을 네트워크 코어에서 네트워크 가장자리로 밀어내어 옮기는 것
		1. 이동장치의 홈 네트워크를 통해 이동장치가 위치한 방문 네트워크 추적
		2. hss 데이터베이스에 존재
	8. 이동장치는 방문 네트워크의 ip 주소가 분명히 필요함
		1. 이동장치의 홈 네트워크와 연결된 영구적인 ip 주소, 방문 네트워크의 주소 범위에서 새로운 주소의 할당, nat를 통한 ip주소 제공등이 포함
	9. 홈 네트워크의 hss만이 이동장치의 위치를 알고있기 때문에 이 방법은 불가능
2. 이동장치로의 간접 라우팅
	1. 1단계
		1. 통신자는 이동 노드가 홈 네트워크에 있는지 방문 네트워크에 있는지 모른느 상태로 데이터그램의 목적지 주소를 이동 노드의 영구적인 주소로 설정한 후 네트워크로 전송
		2. 송신하는 통신자는 이동 장치의 현재 이동 상태를 모름, 통신자에게 이동성에 대한 완전한 투명성 제공
	2. 2단계
		1. HSS -> 방문 네트워크와 상호작용하며 이동장치의 위치 추적, 홈 네트워크와 게이트웨이 라우터 관리
		2. 게이트웨이 라우터 : 해당 네트워크에 집이 있지만 현재 방문 네트워크에 위치해있는 장치를 목적지 주소로 하는 데이터그램이 도착하는지 확인하는 것, 데이터그램을 가로채서 hss와 상이하여 이동 장치가 있는 방문 네트워크를 결정한 후 해당 데이터그램을 방문 네트워크의 게이트웨이 라우터로 전달
	3. 3단계
		1. 방문 네트워크의 게이트웨이 라우터가 데이터그램을 이동장치로 전달, nat 변환이 사용된다면 nat 변환 수행
		2. 재라우팅 : 홈 게이트웨이의 통신자가 원래의 데이터그램을 캡슐화하여 더 큰 데이터그램에 넣게 함, 더 큰 데이터그램은 주소가 지정된 방문 네트워크의 게이트웨이 라우터에 전달되고 캡슐화를 해제하여 더 큰 데이터그램 내에서 원래 데이터그램을 복원하여 이동장치로 전달
	4. 이동 장치가 통신자에게 데이터그램 전송
		1. NAT 변환 수행을 위해 방문 게이트웨이 라우터를 통해 데이터 그램 전달
	5. 4a ) 데이터그램을 홈 게이트웨이 라우터로 다시 터널링하여 거기에서 다시 통신자에게 전달, ===로컬 브레이크 아웃, 데이터그램은 방문 네트워크에서 통신자로 직접 전달
		1. 이동 장치에서 방문 네트워크로의 프로토콜 : 이동장치는 방문 네트워크와 결합, 떠날때 해제
		2. 방문 네트워크에서 홈 네트워크로의 hss 등록 프로토콜 : 방문 네트워크는 홈 네트워크의 hss에 이동 장치 위치 등록하고 
		3. 홈 네트워크 게이트웨이와 방문 네트워크 게이트웨이 라우터 사이의 데이터그램 터널링 프로토콜 : 송신측은 원래 데이터그램을 새로운 데이터그램 내에 캡슐화한 후 목적지로 전달, 수신측에서는 게이트웨이 라우터에서 캡슐화 해제 및 nat 변환을 거쳐 원래 데이터그램을 이동 장치로 전달하는 작업 수행
	6. 이동장치가 한 방문 네트워크에서 다른 방문 네트워크로 로밍할 때 새로운 방문 네트워크 정보가 홈 네트워크 hss에 갱신되어야 하며, 홈 게이트웨이와 방문 게이트웨이 라우터 사이의 터널의 종단점이 이동되어야 한다
3. 이동 장치로의 직접 라우팅
	1. 간접 라우팅 방식의 문제 -> 삼각 라우팅 문제
	2. 훨씬 효율적인 경로가 있음에도 먼저 홈 네트워크로 전달된 다음 방문 네트워크로 전달되어야 함
	3. 직접 라우팅 -> 삼각 라우팅 문제 해결 가능, 그러나 추가적인 복잡도 발생
	4. 통신자가 데이터그램 이동 장치의 방문 네트워크로 직접 터널링해서 전달
		1. 이동 사용자 위치 파악 프로토콜 필요
		2. 이동 장치가 한 방문 네트워크에서 다른 방문 네트워크로 이동할 때 데이터그램을 새로운 방문 네트워크로 전달해야함 인지
			1. 이동 장치가 이동할 때마다 통신자를 미리 갱신해주려면 추가적인 프로토콜 메커니즘 필요

![[스크린샷 2024-01-31 오후 6.17.32.png]]
1 : 데이터그램이 먼저 이동장치의 홈 네트워크로 전달
2 : 홈 네트워크 게이트웨이가 데이터그램을 가로채서 이동장치가 있는 방문 네트워크 결정 후 해당 데이터그램을 방문 네트워크 게이트웨이 라우터로 전달
3 : 방문 네트워크 게이트웨이 라우터가 데이터그램을 이동장치로 전달
### 7.6 실전에서의 이동성 관리

#### 7.6.1 4G/5G 네트워크에서의 이동성 관리

> 차량에 탑승한 이동 사용자가 스마트폰으로 4g/5g 방문 네트워크에 접속하여 원격 서버로부터 hd 비디오 스트리밍을 시작한 후 하나의 4g/5g 기지국 셀 영역으로부터 다른 셀 영역으로 이동하는 시나리오

1. 이동 장치와 기지국 결합 
2. 이동 장치에 대한 네트워크 요소의 제어 평면 구성
	1. 이동 장치가 방문 네트워크에 존재함을 아나태는 제어 평면상태 설정
3. 이동 장치에 대한 포워딩 터널의 데이터 평면 구성
	1. 홈 네트워크의 pdn 게이트웨이를 통한 간접 라우팅을 사용하여 이동 장치와 스트리밍 서버가 ip 데이터그램을 송수신할 수 있는 터널 설정
4. 한 기지국에서 다른 기지국으로의 이동 장치 핸드오버
	1. 핸드오버를 통한 방문 네트워크 결합 지점 변경


##### 1. 기지국 결합
이동장치가 해당 지역의 기지국에서 전송되는 기본 신호에 대해 모든 주파수 영역에서 수신
-> 기지국에 대한 더 많은 정보를 획득하여 결합할 기지국을 선택하고 해당 기지국과 제어 신호 채널을 초기 설정
이동 장치는 홈 네트워크 및 다른 가입자 정보와 IMSI를 기지국에 제공

##### 2. 이동 장치에 대한 lte 네트워크 요소의 제어 평면 구성
이동장치와 기지국 간 신호 채널 설정 -> 기지국은 방문 네트워의 mme와 접촉 가능
- mme는 imsi및 이동 장치에서 제공한 다른 정보를 사용하여 해당 가입자에 대한 인증, 암호화, 가용한 네트워크 서비스 정보를 검색
- 상호 인증 프로세스는 방문 네트워크가 이동 장치의 id에 대해 확신하고 장치가 연결중인 네트워크를 인증할 수 있는지 확인
- mme는 이동 장치가 현재 방문 네트워크에 존재함을 홈 네트워크에 있는 hss에 알리고 hss는 데이터 베이스 갱신
- 기지국과 이동 장치는 둘 사이에 설정될 데이터 평면 채널에 대한 매개변수를 선택

##### 3. 이동 장치에 대한 포워딩 터널의 데이터 평면 구성
2개의 터널이 설립됨
- 기지국과 방문 네트워크의 서빙 게이트 사이에 설립
- 해당 서빙 게이트웨이와 이동 장치의 홈 네트워크에 있는 pdn 게이트웨이 사이에 설립
서빙 게이트웨이가 이동 장치와 동일한 네트워크에 공존하지만 pdn 게이트웨이는 이동 장치와 다른 네트워크에 있을 수 있음(간접라우팅) 
-> 대안방법으로 로컬 브레이크아웃 방법 지정 : 지역의 방문 네트워크에서 pdn 게이트웨이로의 터널 설정

##### 4. 한 기지국에서 다른 기지국으로의 이동 장치 핸드오버
핸드오버는 이동 장치가 한 기지국에서 다른 기지국으로 결합을 변경할 때 발생
데이터그램은 핸드오버 전 현 기지국(출발지 기지국)을 통해 이동장치로 전달, 핸드오버 이후 다른 기지국(목적지 기지국)을통해 이동 장치로 라우팅
기지국간의 핸드오버 -> 이동 장치가 새로운 기지국과 송수신하게 됨, 기지국 측면에서의 서빙 게이트웨이-기지국 간 터널의 변경 초래, 서빙 게이트웨이가 사용중인 Pdn 게이트웨이는 장비의 이동성을 모르는 상태로 유지
핸드오버 발생 이유
	- 현재의 기지국과 이동 장치 사이의 신호가 통신에 장애를 줄 정도로 악화
	- 셀이 혼잡하여 너무 많은 트래픽을 처리해야 하는 경우


### 7.6.2 이동 ip
전체 구조 및 요소 - 셀룰러 사업자 네트워크 구조와 유사
- 이동장치가 영구적인 ip 주소를 갖고있는 홈 네트워크
- 이동장치가 coa를 부여받게 되는 방문 네트워크
이동 ip에서 홈 에이전트 - lte hss와 유사한 기능 수행
- 이동 장치가 방문한 외부 네트워크의 외부 에이전트로부터 업데이트를 수신하여 이동 장치의 위치 추적
홈 네트워크 및 방문/외부 네트워크의 게이트웨이 라우터 연결을 위해 터널을 사용하여 모바일 노드에 대한 간접 라우팅 사용

이동 ip 표준
- 에이전트 발견 : 외부 에이전트가 네트워크에 결합하려는 이동 장치에게 이동성 지원 서비스를 광고하는 데 사용하는 프로토콜 정의
- 홈 에이전트와의 등록 : 이동 장치의 홈 에이전트에 coa를 등록 및 취소하기 위해 이동 장치 및 외부 에이전트에서 사용하는 프로토콜 정의
- 데이터그램 간접 라우팅 : 데이터그램이 홈 에이전트에 의해 이동 장치로 전달되는 방식 정의

## 7.7 무선과 이동성 : 상위 계층 프로토콜에의 영향
네
트랜스포트 계층과 애플리케이션 계층 사이에서 유선과 무선 네트워크간의 차이
공통점 : 최선형 전달 서비스를 상위 계층에게 제공
차이점 : TCP 트랜스포트 프로토콜

tcp : 손실되거나 오류가 생긴 세그먼트를 재전송함

이동 사용자 -> 네트워크의 혼잡 또는 핸드오프 때문에 손실 발생
송신자는 세그먼트 손실의 이유를 알 수 없음
-> 혼잡 윈도우를 무조건 감소시켜서 세그먼트 손실이 오류나 핸드오프가 아닌 혼잡에 의해 생겼다고 가정
유선 네트워크보다 무선 네트워크에서 비트 오류가 많이 발생
 -> 비트 오류나 핸드오프로 인한 손실 : 혼잡 윈도우를 감소 시킬 필요가 없음

1990년대 초중반 무선 환경에서 혼잡제어와 관련된 tcp의 무조건적인 반응
-> 해결을 위한 세가지 접근 방법
1. 지역 복구 : 비트 오류가 발생했을 때 오류 발생 지점에서 복구해주는 것
2. TCP 송신자의 무선 링크 인지 : 유선 네트워크에서의 혼잡으로 인한 손실에 대해서만 혼잡 제어를 하게 함
3. 연결 분리 방법 : 무선 사용자의 종단간 연결을 2개의 트랜스포트 계층 연결로 분리, 하나는 무선 사용자와 ap, 다른 하나는 ap와 목적지 종단점 간 설정 -> 유선 부분과 무선 부분으로 분리

무선 및 이동성이 애플리케이션 계층 프로토콜에 미치는 영향
무선 스펙트럼의 공유 특성
- 셀룰러 무선 링크를 통해 동작하는 응용에게 대역폭은 매우 부족한 자원, 그러나 다양한 종류의 위치 인식 또는 문맥 인식 애플리케이션이 가능해짐
- 향후 유비쿼터스 컴퓨팅 환경 실현에서 아주 핵심적인 역할을 하게 될 것


## 8.1 네트워크 보안이란 무엇인가?

##### 안전한 통신
- 기밀성 : 송신자와 지정된 수신자만이 전송되는 메시지 내용을 이해할 수 있어야 함
	- 도청자가 해석할 수 없도로고 메시지를 암호화 해야함
- 메시지 무결성 : 통신 내용이 전송 도중에 변경되지 않았음을 확인
	- 체크섬 기술 확장으로 메시지 무결성 제공
- 종단점 인증 : 통신에 참여하는 상대방이 실제 누구인지 확인하기 위해 상대방 신원 확인
- 운영 보안 : 공공 인터넷에 연결된 네트워크는 외부로부터 공격을 받을 수 있는 잠재적 위험을 가짐
	- 호스트 컴퓨터에 웜을 이식하고 기밀을 빼내며 내부 네트워크 설정을 변경하고 DoS 공격을 시도할 수 있음

##### 침임자가 접근하려는 정보의 종류와 침입자가 취하는 행동 양식

- 엿듣기 : 채널상의 제어 메시지 및 데이터 메시지를 스니핑하거나 기록
- 메시지 혹은 메시지 내용의 조작 삽입 혹은 삭제

적절한 조치 x -> 침입자는 도청, 위장, 통신연결 가로채기, 시스템 자원 부하 등의 다양한 보안 공격


